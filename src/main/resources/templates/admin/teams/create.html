<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/admin-layout}"
>
  <head>
    <title layout:title-pattern="Create Team - %s">Create Team</title>
    <link rel="stylesheet" th:href="@{/css/user-form.css?v=1.3}" />
  </head>
  <body>
    <section layout:fragment="content">
      <div class="content-header">
        <h1>Create New Team</h1>
        <div class="header-actions">
          <a th:href="@{/admin/teams}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Back to List
          </a>
        </div>
      </div>

      <!-- Error Messages -->
      <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
        <i class="fas fa-exclamation-circle"></i>
        <span th:text="${errorMessage}"></span>
      </div>

      <div class="form-container">
        <form
          id="teamForm"
          class="form-horizontal"
          th:action="@{/admin/teams}"
          method="post"
        >
          <!-- Basic Information -->
          <fieldset>
            <legend>Basic Information</legend>

            <div class="form-group">
              <label for="name" class="form-label"
                >Team Name <span class="required">*</span></label
              >
              <input
                type="text"
                class="form-control"
                id="name"
                name="name"
                th:value="${team != null ? team.name : ''}"
                placeholder="Enter team name"
                required
              />
              <div
                class="error-message"
                th:if="${errors != null && errors.hasFieldErrors('name')}"
                th:text="${errors.getFieldError('name').defaultMessage}"
              ></div>
            </div>

            <div class="form-group">
              <label for="description" class="form-label">Description</label>
              <textarea
                class="form-control"
                id="description"
                name="description"
                rows="4"
                th:text="${team != null ? team.description : ''}"
                placeholder="Enter team description..."
              ></textarea>
              <div
                class="error-message"
                th:if="${errors != null && errors.hasFieldErrors('description')}"
                th:text="${errors.getFieldError('description').defaultMessage}"
              ></div>
            </div>
          </fieldset>

          <!-- Leadership -->
          <fieldset>
            <legend>Leadership</legend>

            <div class="form-group">
              <label for="leaderId" class="form-label">Team Leader</label>
              <select class="form-control" id="leaderId" name="leaderId">
                <option value="">No leader assigned</option>
                <option
                  th:each="user : ${users}"
                  th:value="${user.id}"
                  th:text="${user.name + ' (' + user.email + ')'}"
                  th:selected="${team != null && team.leaderId == user.id}"
                ></option>
              </select>
              <small class="form-text"
                >Optional: Select a team leader. You can assign or change the
                leader later.</small
              >
            </div>
          </fieldset>

          <!-- Form Actions -->
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-save"></i> Create Team
            </button>
            <a th:href="@{/admin/teams}" class="btn btn-secondary">
              <i class="fas fa-times"></i> Cancel
            </a>
          </div>
        </form>
      </div>
    </section>

    <th:block layout:fragment="scripts">
      <script>
        // Add any client-side validation or dynamic behavior here
        document
          .getElementById("teamForm")
          .addEventListener("submit", function (e) {
            const teamName = document.getElementById("name").value.trim();
            if (!teamName) {
              e.preventDefault();
              alert("Team name is required!");
              return false;
            }
          });
      </script>
    </th:block>
  </body>
</html>
